var t=Object.defineProperty,e=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s,r=(t,e)=>{for(var i in e||(e={}))l.call(e,i)&&o(t,i,e[i]);if(s)for(var i of s(e))a.call(e,i)&&o(t,i,e[i]);return t},d=(t,s)=>e(t,i(s));import{d as c}from"./index.cd906f01.js";import{k as n,o as m,c as p,a as f,F as u,s as y,t as x,e as g,d as v,x as b,y as h,g as w}from"./vendor.57260a3e.js";const k={name:"ActivityManager",data:()=>({form:{},activities:[]}),methods:{deleteActivities(t,e){c.collection(t).where("activityId","==",e).get().then((e=>{e.forEach((e=>{c.doc(`${t}/${e.id}`).delete().then().catch()}))}))},createActivity(){c.collection("activities").add(d(r({},this.form.fields),{createdAt:new Date,status:!0})).then((t=>{this.form.visibility=!1})).catch((t=>console.error("Error adding document: ",t)))},editActivity(t,e){this.resetForm();let i=this.activities[e];this.form.title=`Update activity "${i.title}"`,this.form.activityId=i.id,this.form.fields.title=i.title,this.form.fields.description=i.description,this.form.fields.type=i.type,this.form.fields.mulct=i.mulct},deleteActivity(t,e){confirm("Are you sure you want to permanently delete this Activity, it will be also deleted from all pages")&&(c.collection("activities").doc(t).delete().then().catch(),this.deleteActivities("user_activity",t),this.deleteActivities("missed_activities",t),this.deleteActivities("completed_activities",t),this.activities.slice(e,1))},updateActivity(t){c.collection("activities").doc(t).update(d(r({},this.form.fields),{updatedAt:new Date})).then((()=>this.form.visibility=!1)).catch()},resetForm(){this.form={fields:{title:"",description:"",type:"",mulct:""},errors:{},activityId:!1,visibility:!0,title:"Create new activity"}},async toggleStatus(t,e){if(e)return this.toggleActivity(t,e);let i=(await c.collection("user_activity").where("activityId","==",t).get()).docs;for(let s of i){let t=n(s.data().lastCheck.toDate()).startOf("day"),e=n().startOf("day");if(0!==t.diff(e,"day"))return alert("Please run missed Activities, and try again")}return this.toggleActivity(t,e)},toggleActivity(t,e){c.collection("activities").doc(t).update({status:e})}},created(){c.collection("activities").onSnapshot((t=>{this.activities=[],t.forEach((t=>{this.activities.unshift(r({id:t.id},t.data()))}))}))}},A=f("div",{class:"flex justify-center w-2/6 mx-auto shadow overflow-hidden border-b border-gray-200 sm:rounded-lg my-6"},[f("div",{class:"text-2xl px-10 py-10"},"Activities")],-1),D={class:"flex justify-end lg:container"},_={class:"flex flex-col container mx-auto"},j={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},O={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},C={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},S={class:"min-w-full divide-y divide-gray-200"},I=f("thead",{class:"bg-gray-50"},[f("tr",null,[f("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Title "),f("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Description "),f("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),f("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Mulct "),f("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Created At "),f("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Updated At "),f("th",{scope:"col",class:"relative px-6 py-3"},[f("span",{class:"sr-only"},"Edit")]),f("th",{scope:"col",class:"relative px-6 py-3"},[f("span",{class:"sr-only"},"Delete")])])],-1),E={class:"bg-white divide-y divide-gray-200"},P={class:"px-6 py-4 whitespace-nowrap"},U={class:"flex items-center"},F={class:"ml-4"},T={class:"text-sm font-medium text-gray-900"},q={class:"px-6 py-4 whitespace-nowrap"},V={class:"text-sm text-gray-900"},M={class:"text-sm text-gray-500"},N={class:"px-6 py-4 whitespace-nowrap"},$={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},B={class:"text-sm text-gray-900"},G={class:"text-sm text-gray-500"},H={key:0,class:"px-6 py-4 whitespace-nowrap"},J={class:"text-sm text-gray-900"},K={class:"text-sm text-gray-500"},L={key:1,class:"px-6 py-4 whitespace-nowrap"},Q=f("div",{class:"text-sm text-gray-900"},"______",-1),R=f("div",{class:"text-sm text-gray-500"},"______",-1),W={class:"px-6 font-medium"},X={class:"px-6 font-medium"},Y={key:0,class:"fixed z-20 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Z={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},tt=f("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1),et={class:"inline-block align-bottom bg-white rounded-lg text-left bg-green-500 shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},it={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},st={class:"sm:flex sm:items-start"},lt={class:"mt-3 w-full text-center sm:mt-0 sm:ml-4 sm:text-left"},at={class:"text-lg leading-6 font-medium text-gray-900"},ot={class:"mt-2"},rt={class:"shadow overflow-hidden sm:rounded-md"},dt={class:"px-4 py-5 bg-white sm:p-6"},ct={class:"grid grid-cols-6 gap-6"},nt={class:"col-span-6 sm:col-span-4"},mt=f("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"Title",-1),pt={class:"col-span-6 sm:col-span-4"},ft=f("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"Description",-1),ut={class:"col-span-6 sm:col-span-3"},yt=f("label",{for:"type",class:"block text-sm font-medium text-gray-700"},"Type",-1),xt=f("option",{value:"daily"},"Daily",-1),gt={class:"col-span-6 sm:col-span-4"},vt=f("label",{for:"mulct",class:"block text-sm font-medium text-gray-700"},"Mulct",-1),bt=f("div",{class:"px-4 py-3 bg-gray-50 text-right sm:px-6"},[f("button",{type:"submit",class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Save ")],-1);k.render=function(t,e,i,s,l,a){return m(),p(u,null,[A,f("div",D,[f("button",{onClick:e[1]||(e[1]=(...t)=>a.resetForm&&a.resetForm(...t)),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full mb-3"}," New Activity ")]),f("div",_,[f("div",j,[f("div",O,[f("div",C,[f("table",S,[I,f("tbody",E,[(m(!0),p(u,null,y(t.activities,((e,i)=>(m(),p("tr",{key:e.id},[f("td",P,[f("div",U,[f("div",F,[f("div",T,x(e.title),1)])])]),f("td",q,[f("div",V,x(e.description),1),f("div",M,x(e.type),1)]),f("td",N,[e.status?(m(),p("span",{key:0,class:"px-2 select-none inline-flex text-xs leading-5 font-semibold rounded-full cursor-pointer bg-green-100 text-green-800",onDblclick:t=>a.toggleStatus(e.id,!1)}," Active ",40,["onDblclick"])):(m(),p("span",{key:1,class:"px-2 select-none inline-flex text-xs leading-5 font-semibold rounded-full cursor-pointer bg-red-100 text-red-800",onDblclick:t=>a.toggleStatus(e.id,!0)}," Disabled ",40,["onDblclick"]))]),f("td",$,x(e.mulct),1),f("td",z,[f("div",B,x(t.formatDateTime(e.createdAt)),1),f("div",G,x(t.fromNow(e.createdAt)),1)]),e.updatedAt?(m(),p("td",H,[f("div",J,x(t.formatDateTime(e.updatedAt)),1),f("div",K,x(t.fromNow(e.updatedAt)),1)])):(m(),p("td",L,[Q,R])),f("td",W,[f("button",{onClick:t=>a.editActivity(e.id,i),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full"},"Edit ",8,["onClick"])]),f("td",X,[f("button",{onClick:t=>a.deleteActivity(e.id,i),class:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full"},"Delete ",8,["onClick"])])])))),128))])])])])])]),t.form.visibility?(m(),p("div",Y,[f("div",Z,[f("div",{onClick:e[2]||(e[2]=e=>t.form.visibility=!1),class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),tt,f("div",et,[f("div",it,[f("div",st,[f("div",lt,[f("h3",at,x(t.form.title),1),f("div",ot,[f("form",{onSubmit:e[7]||(e[7]=g((e=>t.form.activityId?a.updateActivity(t.form.activityId):a.createActivity()),["prevent"]))},[f("div",rt,[f("div",dt,[f("div",ct,[f("div",nt,[mt,v(f("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=e=>t.form.fields.title=e),id:"title",autocomplete:"title",required:"",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[b,t.form.fields.title]])]),f("div",pt,[ft,v(f("textarea",{"onUpdate:modelValue":e[4]||(e[4]=e=>t.form.fields.description=e),id:"description",rows:"3",required:"",class:"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 mt-1 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"Activity details..."},null,512),[[b,t.form.fields.description]])]),f("div",ut,[yt,v(f("select",{id:"type","onUpdate:modelValue":e[5]||(e[5]=e=>t.form.fields.type=e),required:"",autocomplete:"country",class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},[xt],512),[[h,t.form.fields.type]])]),f("div",gt,[vt,v(f("input",{"onUpdate:modelValue":e[6]||(e[6]=e=>t.form.fields.mulct=e),type:"number",id:"mulct",autocomplete:"title",required:"",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[b,t.form.fields.mulct]])])])]),bt])],32)])])])])])])])):w("",!0)],64)};export default k;
